<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8" />
    <title>Website Tuyển Sinh</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Le Hieu đẹp trai nhất hệ mặt trời" name="description" />
    <meta content="Coderthemes" name="author" />
    <!-- App favicon -->
    
    <!-- third party css -->
    <link th:href="@{/assets/css/vendor/jquery-jvectormap-1.2.2.css}" rel="stylesheet" type="text/css" />
    <!-- third party css end -->
    <!-- App css -->
    <link th:href="@{/assets/css/icons.min.css}" rel="stylesheet" type="text/css" />
    <link th:href="@{/assets/css/app.min.css}" rel="stylesheet" type="text/css" id="app-style" />

    <!------------------------------ news ---------------------------------->
    <link rel="shortcut icon" th:href="@{/assets/images/index/iconlogo.png}">
    <link th:href="@{/styleindex.css}" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css">
        
</head>

<body class="loading" data-layout-color="light" data-leftbar-theme="dark" data-layout-mode="fluid"
    data-rightbar-onstart="true">
    <!-- Begin page -->

    <div class="wrapper">
        <!-- ========== Left Sidebar Start ========== -->
        <div th:include="menu/menuleft :: menu-left" id="menuleft" class="leftside-menu"></div>
                <!-- End Sidebar -->

            </div>
            <!-- Sidebar -left -->

        </div>
        
        <!-- Left Sidebar End -->

        <!-- ============================================================== -->
        <!-- Start Page Content here -->
        <!-- ============================================================== -->

        <div class="content-page">
            <div class="content">
                <!-- Topbar Start -->
                <div th:include="fragments/fragmentheader :: header" class="navbar-custom"></div>
                <!-- end Topbar -->

                <!-- Start Content-->
                <div class="container-fluid">

                    <!-- start page title -->
                    <div class="row">
                        <div class="col-12">
                            <div class="page-title-box">
                                <div class="page-title-right">
                                    <form class="d-flex">
                                        <div class="input-group">
                                            <input type="text" class="form-control form-control-light"
                                                id="dash-daterange">
                                            <span class="input-group-text bg-success border-success text-white">
                                                <i class="mdi mdi-calendar-range font-13"></i>
                                            </span>
                                        </div>
                                        <a href="javascript: void(0);" class="btn btn-success ms-2">
                                            <i class="mdi mdi-autorenew"></i>
                                        </a>
                                        <a href="javascript: void(0);" class="btn btn-success ms-1">
                                            <i class="mdi mdi-filter-variant"></i>
                                        </a>
                                    </form>
                                </div>
                                <h4 class="page-title">Thêm Tài khoản</h4>
                            </div>
                        </div>
                    </div>
                    <!-- end page title -->
            <!-- ------------------------------start content------------------------------ -->
                    <div class="content">
                        <div class="container1">
                            <div class="row mt-3">
                                <div class="col-sm-12">
                                    <form class="w-25 m-auto" id="signupForm">
                                        <label class="form-label" for="">Tên tài khoản</label>
                                        <input class="form-control" type="text" name="username" id="username" placeholder="Nhập tên tài khoản">
                                        <label class="form-label mt-2" for="">Mật khẩu</label>
                                        <input class="form-control" type="password" name="password" id="password" placeholder="Nhập mật khẩu">
                                        <label class="form-label mt-2" for="">Email</label>
                                        <input class="form-control" type="text" name="email" id="email" placeholder="Nhập email">
                                        <label class="form-label mt-2">Quyền</label>
                                        <select class="form-select" name="roles" id="roles">
                                            <option value="admin">Admin</option>
									        <option value="ctsv">CTSV</option>
									        <option value="daotao">Đào tạo</option>
									        <option value="taivu">Tài vụ</option>
                                        </select>
                                        <div class="text-center mt-2">
                                            <input  class="btn btn-success" type="submit" value="Thêm">
                                        </div>
                                    </form>
									<div id="success" class="m-auto w-50 px-4 py-2 rounded-3 text-white d-none mt-4" style="background-color: #0BCE97; text-align: center;">
		                            	<span>Đăng ký thành công!</span>
		                            </div>
		                            <div id="fail" class="m-auto w-50 px-4 py-2 rounded-3 text-white d-none mt-4" style="background-color: #FF0000; text-align: center;">
		                            	<span>Đăng ký thất bại, Tên tài khoản hoặc email đã được sử dụng!</span>
		                            </div>
		                            <p id="message" style="color: #FF0000; font-weight: bold; text-align: center; margin-top: 20px;"></p>
                                </div>
                            </div>
                        </div>

                    </div>
                    

                    <!-- end table -->
                    <div class="small_box_bottom"></div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="card widget-flat">
                        </div> <!-- end card-->
                    </div> <!-- end col-->
                </div> <!-- end col -->
            </div>
            <!-- container -->

        </div>
        <!-- content -->

        <!-- Footer Start -->
        <footer class="footer">
            <div class="container-fluid">
                <div class="row1">
                    <div class="col-md-12">
                        <span>Copyright © 2017-2023 - Trường Đại học Công nghệ Thông tin & Truyền Thông Việt - Hàn, Đại
                            học Đà Nẵng</span>
                    </div>
                    <div class="col-md-12">
                        <div><span></span><i class="fa-solid fa-house"></i> Địa chỉ: Khu Đô thị Đại học Đà Nẵng, Đường
                            Nam Kỳ Khởi Nghĩa, quận Ngũ Hành Sơn, TP. Đà Nẵng <br>
                            <span></span><i class="fa-solid fa-square-phone"></i></i> Điện thoại: 0236.6.552.688

                            &nbsp;&nbsp;&nbsp;&nbsp;<i class="fa-solid fa-envelope"></i> daotao@vku.udn.vn
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- end Footer -->

    </div>

    <!-- ============================================================== -->
    <!-- End Page content -->
    <!-- ============================================================== -->


    </div>
    <!-- END wrapper -->

    <!-- Right Sidebar -->
    <div class="end-bar">

        <div class="rightbar-title">
            <a href="javascript:void(0);" class="end-bar-toggle float-end">
                <i class="dripicons-cross noti-icon"></i>
            </a>
            <h5 class="m-0">Settings</h5>
        </div>

        <div class="rightbar-content h-100" data-simplebar>

            <div class="p-3">
                <div class="alert alert-warning" role="alert">
                    <strong>Customize </strong> the overall color scheme, sidebar menu, etc.
                </div>

                <!-- Settings -->
                <h5 class="mt-3">Color Scheme</h5>
                <hr class="mt-1" />

                <div class="form-check form-switch mb-1">
                    <input class="form-check-input" type="checkbox" name="color-scheme-mode" value="light"
                        id="light-mode-check" checked>
                    <label class="form-check-label" for="light-mode-check">Light Mode</label>
                </div>

                <div class="form-check form-switch mb-1">
                    <input class="form-check-input" type="checkbox" name="color-scheme-mode" value="dark"
                        id="dark-mode-check">
                    <label class="form-check-label" for="dark-mode-check">Dark Mode</label>
                </div>


                <!-- Width -->
                <h5 class="mt-4">Width</h5>
                <hr class="mt-1" />
                <div class="form-check form-switch mb-1">
                    <input class="form-check-input" type="checkbox" name="width" value="fluid" id="fluid-check" checked>
                    <label class="form-check-label" for="fluid-check">Fluid</label>
                </div>

                <div class="form-check form-switch mb-1">
                    <input class="form-check-input" type="checkbox" name="width" value="boxed" id="boxed-check">
                    <label class="form-check-label" for="boxed-check">Boxed</label>
                </div>


                <!-- Left Sidebar-->
                <h5 class="mt-4">Left Sidebar</h5>
                <hr class="mt-1" />
                <div class="form-check form-switch mb-1">
                    <input class="form-check-input" type="checkbox" name="theme" value="default" id="default-check">
                    <label class="form-check-label" for="default-check">Default</label>
                </div>

                <div class="form-check form-switch mb-1">
                    <input class="form-check-input" type="checkbox" name="theme" value="light" id="light-check" checked>
                    <label class="form-check-label" for="light-check">Light</label>
                </div>

                <div class="form-check form-switch mb-3">
                    <input class="form-check-input" type="checkbox" name="theme" value="dark" id="dark-check">
                    <label class="form-check-label" for="dark-check">Dark</label>
                </div>

                <div class="form-check form-switch mb-1">
                    <input class="form-check-input" type="checkbox" name="compact" value="fixed" id="fixed-check"
                        checked>
                    <label class="form-check-label" for="fixed-check">Fixed</label>
                </div>

                <div class="form-check form-switch mb-1">
                    <input class="form-check-input" type="checkbox" name="compact" value="condensed"
                        id="condensed-check">
                    <label class="form-check-label" for="condensed-check">Condensed</label>
                </div>

                <div class="form-check form-switch mb-1">
                    <input class="form-check-input" type="checkbox" name="compact" value="scrollable"
                        id="scrollable-check">
                    <label class="form-check-label" for="scrollable-check">Scrollable</label>
                </div>

                <div class="d-grid mt-4">
                    <button class="btn btn-success" id="resetBtn">Reset to Default</button>

                    <a href="https://themes.getbootstrap.com/product/hyper-responsive-admin-dashboard-template/"
                        class="btn btn-success mt-3" target="_blank"><i class="mdi mdi-basket me-1"></i> Purchase Now</a>
                </div>
            </div> <!-- end padding-->

        </div>
    </div>

    <div class="rightbar-overlay"></div>
    <!-- /End-bar -->
    
    <script th:inline="javascript">
	
        document.getElementById("signupForm").addEventListener("submit", function (event) {
            event.preventDefault();
            
            var signupUrl = "/admin/account/signup"; // URL của API đăng ký trên backend
            

            var username = document.getElementById("username").value;
            var password = document.getElementById("password").value;
            var email = document.getElementById("email").value;
            var roles = Array.from(document.getElementById("roles").selectedOptions).map(option => option.value);
            //var roles = document.getElementById("roles").value
            // Kiểm tra định dạng email trước khi gửi yêu cầu đăng ký
            if (!isValidEmail(email)) {
                document.getElementById("message").textContent = "email không hợp lệ với định dạng @vku.udn.vn";
                setTimeout(function() {
                    document.getElementById("message").textContent = ""; // Clear the message after a delay
                }, 3000);
                return;
            }

            var signupRequest = {
                username: username,
                password: password,
                email: email,
                role: roles
            };

            fetch(signupUrl, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(signupRequest)
            }).then(response => {
				if (response.ok) {
					success = document.getElementById("success");
					success.classList.remove('d-none');
					setTimeout(() => {
							success.classList.add('d-none');
					}, 3000);
				}
				else {
					response.text().then(errorMessage => {
						fail = document.getElementById("fail");
						fail.classList.remove('d-none');
						setTimeout(() => {
							fail.classList.add('d-none');
						}, 3000);
					});

				}
			})
        });

        function isValidEmail(email) {
            // Sử dụng regex để kiểm tra định dạng email
            var emailPattern = /^[^\s@]+@vku\.udn\.vn$/;
            return emailPattern.test(email);
        }
	</script>
	
				<script th:inline="javascript">
				var logout = document.getElementById("logoutLink");
				logout.addEventListener("click", function () {
		            // Fetch data from the server
		            fetch("/admin/login/logout", {
			                method: "POST",
			            })
			            .then((response) => {
			            	
			                // Check if the response status is 200 (OK) for a successful logout
			                window.location.href = "/admin/login";
			                sessionStorage.clear();
			            })
			            .catch((error) => {
			                console.error("Logout error:", error);
			            });
				})

    		</script>
    	

    <!-- bundle -->
    <script th:src="@{/assets/js/vendor.min.js}"></script>
    <script th:src="@{/assets/js/app.min.js}"></script>

    <!-- third party js -->
    <script th:src="@{/assets/js/vendor/apexcharts.min.js}"></script>
    <script th:src="@{/assets/js/vendor/jquery-jvectormap-1.2.2.min.js}"></script>
    <script th:src="@{/assets/js/vendor/jquery-jvectormap-world-mill-en.js}"></script>
    <!-- third party js ends -->

    <!-- demo app -->
    <script th:src="@{/assets/js/pages/demo.dashboard.js}"></script>
    <script th:src="@{/assets/js/clock.js}"></script>
    <!-- end demo js-->
</body>

</html>